{"version":3,"sources":["assets\\Script\\game_control.js"],"names":["TagOfDirection","cc","Enum","up","right","down","left","no","Class","Component","properties","game_maps","Node","direction","fire_btn","game_info","shield_prefab","Prefab","appear_prefab","bullet_prefab","enemy_tank_prefab","player_tank_prefab","fire_flower_prefab","props_prefab","game_map_prefab","toast","game_result","game_over","game_stage","point_prefab","start","vv","Global","game","startGame","stage_info","Config","stage","UserInfo","level","die_tank","tank_1","tank_2","tank_3","tank_4","tieqiao_time","dinglei_time","is_pause","is_over","is_enemy_tank_pause","is_show_over","props","player_direction","enemy_index","enemy_tank_arr","bullet_arr","frame_count","enemy_count","destroyAllChildren","game_map","instantiate","addChild","map","getComponent","initMap","player","live","data","moveSpeed","fireSpeed","tank_level","initPlayer","initView","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","result","node","x","y","enemys","getChildByName","live_count","width","winSize","height","i","childrenCount","enemy","children","active","Label","string","initTank","length","push","initEnemy","onClickBack","director","loadScene","checkBullet","isValid","splice","checkEnemyTank","checkPlayerTank","event","keyCode","macro","KEY","space","onFire","update","dt","_this","time","Date","getTime","bg2","repairHome","text","state","init","scheduleOnce","status","moveUp","moveRight","moveDown","moveLeft"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar TagOfDirection = cc.Enum({\r\n    up : 0,\r\n    right : 1,\r\n    down : 2,\r\n    left : 3,\r\n    no : 4,\r\n})\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // game_map: cc.Node,\r\n        game_maps: cc.Node,\r\n        direction: cc.Node,\r\n        fire_btn: cc.Node,\r\n        game_info: cc.Node,\r\n\r\n        shield_prefab: cc.Prefab,\r\n        appear_prefab: cc.Prefab,\r\n        bullet_prefab: cc.Prefab,\r\n        enemy_tank_prefab: cc.Prefab,\r\n        player_tank_prefab: cc.Prefab,\r\n        fire_flower_prefab: cc.Prefab,\r\n        props_prefab: cc.Prefab,\r\n\r\n        game_map_prefab: cc.Prefab,\r\n\r\n        toast: cc.Prefab,\r\n        game_result: cc.Prefab,\r\n        game_over: cc.Prefab,\r\n        game_stage: cc.Prefab,\r\n        point_prefab: cc.Prefab,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        cc.vv.Global.game = this\r\n\r\n        this.startGame()\r\n    },\r\n\r\n    startGame (){\r\n        cc.vv.Global.stage_info = cc.vv.Config.stage['stage_'+cc.vv.UserInfo.level]()\r\n        cc.vv.Global.die_tank = {\r\n            tank_1 : 0,\r\n            tank_2 : 0,\r\n            tank_3 : 0,\r\n            tank_4 : 0,\r\n        }\r\n\r\n        cc.vv.Global.tieqiao_time = null\r\n        cc.vv.Global.dinglei_time = null\r\n\r\n        this.is_pause = true\r\n        this.is_over = true\r\n        this.is_enemy_tank_pause = false\r\n        this.is_show_over = false\r\n\r\n        this.props = null\r\n        this.player_direction = TagOfDirection.no\r\n        this.enemy_index = 0\r\n        this.enemy_tank_arr = []\r\n        this.bullet_arr = []\r\n\r\n        this.frame_count = 0\r\n        cc.vv.Global.enemy_count = 20\r\n\r\n        this.game_maps.destroyAllChildren()\r\n        this.game_map = cc.instantiate(this.game_map_prefab)\r\n        this.game_maps.addChild(this.game_map)\r\n        \r\n        this.map = this.game_map.getComponent('game_map')\r\n        this.map.initMap()\r\n\r\n        if (this.player){\r\n            cc.vv.UserInfo.live++\r\n            let data = {\r\n                moveSpeed : this.player.moveSpeed,\r\n                fireSpeed : this.player.fireSpeed,\r\n                tank_level : this.player.tank_level,\r\n            }\r\n            this.player = this.map.initPlayer(data)\r\n            this.player_direction = TagOfDirection.no\r\n        }\r\n        this.initView()\r\n\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n\r\n        let result = cc.instantiate(this.game_stage)\r\n        this.node.addChild(result)\r\n    },\r\n\r\n    initView(){\r\n        let x = 0\r\n        let y = 0\r\n        let enemys = this.game_info.getChildByName('enemys')\r\n        // let ip = this.game_info.getChildByName('ip')\r\n        // let live_tank = this.game_info.getChildByName('live_tank')\r\n        let live_count = this.game_info.getChildByName('live_count')\r\n        // let flag = this.game_info.getChildByName('flag')\r\n        let level = this.game_info.getChildByName('level')\r\n        x =/* (cc.winSize.width - this.game_map.width) / 4 +*/ this.game_map.width / 2 + 30\r\n        y = cc.winSize.height / 2 - 5\r\n        for (let i=0;i<enemys.childrenCount;i++){\r\n            // if (i%2==0){\r\n            //     y -= 15\r\n            // }\r\n            // let temp_x = x\r\n            // if (i%2==1){\r\n            //     temp_x -= 8\r\n            // }\r\n            // else {\r\n            //     temp_x += 8\r\n            // }\r\n            let enemy = enemys.children[i]\r\n            // enemy.position = cc.v2(temp_x, y)\r\n            enemy.active = false\r\n        }\r\n        for (let i=0;i<cc.vv.Global.enemy_count;i++){\r\n            let enemy = enemys.children[i]\r\n            enemy.active = true\r\n        }\r\n\r\n        y = 15\r\n        // ip.position = cc.v2(x, y)\r\n        // live_tank.position = cc.v2(x-10, y-20)\r\n        // live_count.position = cc.v2(x+10, y-20)\r\n\r\n        // flag.position = cc.v2(x, y-60)\r\n        // level.position = cc.v2(x+10, y-80)\r\n\r\n        x = (cc.winSize.width - this.game_map.width) / 4 + this.game_map.width / 2\r\n        y = cc.winSize.height * 0.25\r\n        // this.direction.position = cc.v2(-x, -y)\r\n        // this.fire_btn.position = cc.v2(x, -y)\r\n\r\n        live_count.getComponent(cc.Label).string = cc.vv.UserInfo.live\r\n        level.getComponent(cc.Label).string = cc.vv.UserInfo.level\r\n    },\r\n\r\n    initTank (){\r\n        if (!this.player){\r\n            let data = {\r\n                moveSpeed : 1.2,\r\n                fireSpeed : 3,\r\n                tank_level : 3\r\n            }\r\n            this.player = this.map.initPlayer()\r\n            this.player_direction = TagOfDirection.no\r\n        }\r\n        if (this.enemy_tank_arr.length < 4){\r\n            this.enemy_tank_arr.push(this.map.initEnemy())\r\n        }\r\n    },\r\n\r\n    onClickBack (){\r\n        cc.director.loadScene('home_scene')\r\n    },\r\n\r\n    checkBullet (){\r\n        for (let i=0;i<this.bullet_arr.length;i++){\r\n            if (!this.bullet_arr[i].isValid){\r\n                this.bullet_arr.splice(i, 1)\r\n                i--\r\n            }\r\n        }\r\n    },\r\n\r\n    checkEnemyTank (){\r\n        for (let i=0;i<this.enemy_tank_arr.length;i++){\r\n            if (!this.enemy_tank_arr[i] || !this.enemy_tank_arr[i].node || !this.enemy_tank_arr[i].node.isValid){\r\n                this.enemy_tank_arr.splice(i, 1)\r\n                i--\r\n            }\r\n        }\r\n    },\r\n\r\n    checkPlayerTank (){\r\n        if (!this.player || !this.player.node || !this.player.node.isValid){\r\n            this.player = null\r\n        }\r\n    },\r\n\r\n    onKeyDown (event) {\r\n        if (!this.player || !this.player.node || !this.player.node.isValid){\r\n            return\r\n        }\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.space:\r\n                this.player.onFire()\r\n                break\r\n            case cc.macro.KEY.left:\r\n                this.player_direction = TagOfDirection.left\r\n                break;\r\n            case cc.macro.KEY.down:\r\n                this.player_direction = TagOfDirection.down\r\n                break\r\n            case cc.macro.KEY.right:\r\n                this.player_direction = TagOfDirection.right\r\n                break\r\n            case cc.macro.KEY.up:\r\n                this.player_direction = TagOfDirection.up\r\n                break\r\n        }\r\n    },\r\n    \r\n    onKeyUp (event) {\r\n        if (!this.player || !this.player.node || !this.player.node.isValid){\r\n            return\r\n        }\r\n        this.player_direction = TagOfDirection.no\r\n    },\r\n\r\n    update(dt){\r\n        if (this.is_pause) return\r\n        this.frame_count ++\r\n        this.initView()\r\n        this.initTank()\r\n        this.checkBullet()\r\n        this.checkEnemyTank()\r\n        this.checkPlayerTank()\r\n\r\n        // 铁锹 -- Hết thời gian của chức năng xẻng - Tòa thành ko phá vỡ\r\n        if (cc.vv.Global.tieqiao_time){\r\n           \r\n            let time = new Date().getTime()\r\n            if ((time - cc.vv.Global.tieqiao_time) / 1000 >= 15){\r\n                this.map.bg2.node.active = false\r\n                cc.vv.Global.tieqiao_time = null\r\n            }\r\n            else if ((time - cc.vv.Global.tieqiao_time) / 1000 >= 10){\r\n                if (this.frame_count % 20 == 0){\r\n                    this.map.bg2.node.active = !this.map.bg2.node.active\r\n                    this.map.repairHome()\r\n                }\r\n            }\r\n            else {\r\n                this.map.bg2.node.active = true\r\n            }\r\n        }\r\n        // 定雷 -- nhặt được cái đồng hồ - enemy đứng lại hết\r\n        if (cc.vv.Global.dinglei_time){\r\n            this.is_enemy_tank_pause = true\r\n            let time = new Date().getTime()\r\n            if ((time - cc.vv.Global.dinglei_time) / 1000 >= 10){\r\n                cc.vv.Global.dinglei_time = null\r\n                this.is_enemy_tank_pause = false\r\n            }\r\n        }\r\n        \r\n        // 游戏结束 -- thua\r\n        if (this.is_over && !this.is_show_over){\r\n            this.is_show_over = true\r\n            let data = {\r\n                text : 'GAME OVER',\r\n                state : 1\r\n            }\r\n            let toast = cc.instantiate(this.toast)\r\n            this.node.addChild(toast)\r\n            toast.getComponent('toast').init(data)\r\n        }\r\n        // 胜利 -- thắng\r\n        if (this.enemy_tank_arr.length == 0 &&  cc.vv.Global.enemy_count <= 0 && !this.is_show_over){\r\n            this.is_show_over = true\r\n            this.is_over = true\r\n            this.scheduleOnce(()=>{\r\n                let data = {\r\n                    status : 1\r\n                }\r\n                let result = cc.instantiate(this.game_result)\r\n                this.node.addChild(result)\r\n                result.getComponent('game_result').init(data)\r\n            }, 5)\r\n        }\r\n        if (this.player && this.player.node.active){\r\n            if (this.player_direction == TagOfDirection.up){\r\n                this.player.moveUp()\r\n            }\r\n            else if (this.player_direction == TagOfDirection.right){\r\n                this.player.moveRight()\r\n            }\r\n            else if (this.player_direction == TagOfDirection.down){\r\n                this.player.moveDown()\r\n            }\r\n            else if (this.player_direction == TagOfDirection.left){\r\n                this.player.moveLeft()\r\n            }\r\n        }\r\n    },\r\n});\r\n"]}